{% extends "dashbase.html" %}

{% block title %}Edit Profile{% endblock title %}

{% block css %}
<style>
  .ml-auto, .mx-auto {
    margin-left: initial !important; /* Reset margin-left */
  }
</style>
{% endblock css %}

{% block maincontent %}
<div class="content">

  <nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      <a class="nav-item nav-link{% if active_tab == 'personal' %} active{% endif %}" id="nav-personal-tab"
        href="{% url 'form_view' tab='personal' %}" role="tab" aria-controls="nav-personal"
        aria-selected="true">Personal</a>
      <a class="nav-item nav-link{% if active_tab == 'education' %} active{% endif %}" id="nav-education-tab"
        href="{% url 'form_view' tab='education' %}" role="tab" aria-controls="nav-education"
        aria-selected="false">Education</a>
      <a class="nav-item nav-link{% if active_tab == 'college_info' %} active{% endif %}" id="nav-college-info-tab"
        href="{% url 'form_view' tab='college_info' %}" role="tab" aria-controls="nav-college-info"
        aria-selected="{% if active_tab == 'college_info' %}true{% else %}false{% endif %}">College Information</a>   
      <a class="nav-item nav-link{% if active_tab == 'document' %} active{% endif %}" id="nav-document-tab"
        href="{% url 'form_view' tab='document' %}" role="tab" aria-controls="nav-document"
        aria-selected="false">Document</a>
      <a class="nav-item nav-link{% if active_tab == 'experience' %} active{% endif %}" id="nav-experience-tab"
        href="{% url 'form_view' tab='experience' %}" role="tab" aria-controls="nav-experience"
        aria-selected="false">Experience</a>
      <a class="nav-item nav-link{% if active_tab == 'project' %} active{% endif %}" id="nav-project-tab"
        href="{% url 'form_view' tab='project' %}" role="tab" aria-controls="nav-project"
        aria-selected="false">Project</a>
      <a class="nav-item nav-link{% if active_tab == 'skills' %} active{% endif %}" id="nav-skills-tab"
        href="{% url 'form_view' tab='skills' %}" role="tab" aria-controls="nav-skills" aria-selected="false">Skills</a>
      <a class="nav-item nav-link{% if active_tab == 'achievements' %} active{% endif %}" id="nav-achievements-tab"
        href="{% url 'form_view' tab='achievements' %}" role="tab" aria-controls="nav-achievements"
        aria-selected="false">Achievements</a>
      <a class="nav-item nav-link{% if active_tab == 'interests' %} active{% endif %}" id="nav-interests-tab"
        href="{% url 'form_view' tab='interests' %}" role="tab" aria-controls="nav-interests"
        aria-selected="false">Interests</a>
      <a class="nav-item nav-link{% if active_tab == 'languages' %} active{% endif %}" id="nav-languages-tab"
        href="{% url 'form_view' tab='languages' %}" role="tab" aria-controls="nav-languages"
        aria-selected="false">Languages</a>
    </div>
  </nav>

  <!-- Progress bar -->
  <div class="progress mb-3">
    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"
      style="width: {{ progress }}%;" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
  
  <div class="tab-content" id="nav-tabContent">
    <!-- Personal tab -->
    <div class="tab-pane fade{% if active_tab == 'personal' %} show active{% endif %}" id="nav-personal" role="tabpanel"
      aria-labelledby="nav-personal-tab">
      {% if personal_info %}
      {% if is_editing %}
      <!-- Display editable fields -->
      <form method="post" action="{% url 'form_view' tab='personal' %}">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab='personal' %}'">Cancel</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab='personal' %}'">View Saved Form</button>
      </form>
      {% else %}
      <!-- Display saved information with disabled fields -->
      <div class="row">
        <form>
          <div class="form-group">
            <label for="date_of_birth">Date of Birth:</label>
            <input type="text" id="date_of_birth" name="date_of_birth" value="{{ personal_info.date_of_birth }}" class="form-control" disabled>
          </div>
          <div class="form-group">
            <label for="gender">Gender:</label>
            <input type="text" id="gender" name="gender" value="{{ personal_info.gender }}" class="form-control" disabled>
          </div>
          <div class="form-group">
            <label for="phone_number">Phone Number:</label>
            <input type="text" id="phone_number" name="phone_number" value="{{ personal_info.phone_number }}" class="form-control" disabled>
          </div>
          <div class="form-group">
            <label for="address">Address:</label>
            <input type="text" id="address" name="address" value="{{ personal_info.address }}" class="form-control" disabled>
          </div>
        </form>
      </div>
      <div class="form-group">
        <label for="profile_picture">Profile Picture:</label><br>
        {% if personal_info.profile_picture %}
        <img src="{{ personal_info.profile_picture.url }}" alt="Profile Picture" class="rounded-circle" style="width: 135px; height: 135px;">
        {% else %}
        <p>No profile picture available</p>
        {% endif %}
      </div>
      <div class="form-group">
        <label for="aadhar_front">Aadhar Card Front:</label><br>
        {% if personal_info.aadhar_front %}
        <img src="{{ personal_info.aadhar_front.url }}" alt="Aadhar Card Front" class="rounded" style="width: 135px; height: 135px;">
        {% else %}
        <p>No profile picture available</p>
        {% endif %}
      </div>
      <div class="form-group">
        <label for="aadhar_back">Aadhar Card Back:</label><br>
        {% if personal_info.aadhar_back %}
        <img src="{{ personal_info.aadhar_back.url }}" alt="Aadhar Card Back" class="rounded" style="width: 135px; height: 135px;">
        {% else %}
        <p>No profile picture available</p>
        {% endif %}
      </div>
      <!-- Edit and Delete buttons -->
      <div class="btn-group" role="group" aria-label="Edit and Delete buttons">
        {% if user.is_authenticated %}
        <!-- Only show delete button to admin users -->
        <form method="post" action="{% url 'delete_personal_info' %}">
          {% csrf_token %}
          <input type="hidden" name="user_id" value="{{ personal_info.user_id }}">
          <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#confirmDelete">Delete & edit again</button>
          <!-- Modal for confirmation -->
          <div class="modal fade" id="confirmDelete" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="confirmDeleteLabel">Confirm Delete</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  Are you sure you want to delete this information?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <button type="submit" class="btn btn-danger">Delete</button>
                </div>
              </div>
            </div>
          </div>
        </form>
        {% endif %}
      </div>
      {% endif %}
      {% else %}
      <!-- Display form fields for input -->
      <form method="post" action="{% url 'form_view' tab='personal' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
      </form>
      {% endif %}
    </div>

    <!-- Education tab -->
    <div class="tab-pane fade{% if active_tab == 'education' %} show active{% endif %}" id="nav-education" role="tabpanel" aria-labelledby="nav-education-tab">
      <h3>Education</h3>
      {% if education_info %}
      <table class="table">
        <thead>
          <tr>
            <th>Education Level</th>
            <th>School/College</th>
            <th>Year</th>
            <th>Percentage</th>
            <th>Certificate</th>
          </tr>
        </thead>
        <tbody>
          {% for info in education_info %}
          <tr>
            <td>10th</td>
            <td>{{ info.tenth_school }}</td>
            <td>{{ info.get_tenth_year_display }}</td>
            <td>{{ info.tenth_percentage }}</td>
            <td>
              {% if info.tenth_school_certificate %}
              <a href="{{ info.tenth_school_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
          </tr>
          <tr>
            <td>12th</td>
            <td>{{ info.twelfth_school }}</td>
            <td>{{ info.get_twelfth_year_display }}</td>
            <td>{{ info.twelfth_percentage }}</td>
            <td>
              {% if info.twelfth_school_certificate %}
              <a href="{{ info.twelfth_school_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
          </tr>
          <tr>
            <td>Degree</td>
            <td>{{ info.degree_college }}</td>
            <td>{{ info.get_degree_year_display }}</td>
            <td>N/A</td>
            <td>
              {% if info.degree_certificate %}
              <a href="{{ info.degree_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% if user.is_authenticated %}
      <form method="post" action="{% url 'delete_education_info' %}">
        {% csrf_token %}
        <input type="hidden" name="info_id" value="{{ info.id }}">
        <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#confirmDelete{{ info.id }}">Delete & edit again</button>
        <!-- Modal for confirmation -->
        <div class="modal fade" id="confirmDelete{{ info.id }}" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteLabel{{ info.id }}" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteLabel{{ info.id }}">Confirm Delete</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                Are you sure you want to delete this education information?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-danger">Delete</button>
              </div>
            </div>
          </div>
        </div>
      </form>
      {% endif %}
      {% else %}
      <p>No education details saved.</p>
      <!-- Display form for input -->
      <form method="post" action="{% url 'form_view' tab='education' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab='college_info' %}'">Next</button>
      </form>
      {% endif %}
    </div>

    <!-- CollegeInfo tab -->
    <div class="tab-pane fade{% if active_tab == 'college_info' %} show active{% endif %}" id="nav-college-info" role="tabpanel" aria-labelledby="nav-college-info-tab">
      <h3>College Information</h3>
      {% if college_info %}
      <!-- Display existing college information -->
      <table class="table">
          <thead>
              <tr>
                  <th>Roll Number</th>
                  <th>MBA Course</th>
                  <th>Specialization</th>
                  <th>Action</th> <!-- Add an action column for editing -->
              </tr>
          </thead>
          <tbody>
              {% for info in college_info %}
              <tr>
                  <td>{{ info.roll_no }}</td>
                  <td>{{ info.course.name }}</td>
                  <td>{{ info.specialization.name  }}</td>
                  <td>
                      <button type="button" class="btn btn-primary" onclick="window.location.href='{% url 'form_view' tab='college_info' %}?edit_instance_id={{ info.id }}'">Edit</button>
                  </td>
              </tr>
              {% endfor %}
          </tbody>
      </table>
      {% else %}
      <p>No College Info details saved.</p>
      {% endif %}
      <!-- Display form for input -->
      <form method="post" action="{% url 'form_view' tab='college_info' %}" enctype="multipart/form-data" id="college-info-form">
          {% csrf_token %}
          {{ current_form.as_p }}
          <button type="submit" class="btn btn-primary">Save</button>
          <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab='education' %}'">Next</button>
      </form>
    </div>

    <!--Document tab -->
    <div class="tab-pane fade{% if active_tab == 'document' %} show active{% endif %}" id="nav-document" role="tabpanel" aria-labelledby="nav-document-tab">
      <h3>Document</h3>
      {% if document %}
      <!-- Display saved experience details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Document Type</th>
            <th>Document File</th>
            <th>View Document</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for doc in document %}
          <tr>
            <td>{{ doc.get_document_type_display }}</td>
            <td>{{ doc.document_file }}</td>
            <td>
              {% if doc.document_file %}
              <a href="{{ doc.document_file.url }}" target="_blank">View Document</a>
              {% else %}
              No document uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary"
                onclick="window.location.href='{% url 'form_view' tab='document' %}?edit_instance_id={{ doc.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=doc.id %}" method="post"
                style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No experience details saved.</p>
      {% endif %}
      <form method="post" action="{% url 'form_view' tab='document' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>
    </div>

    <!--Experience tab -->
    <div class="tab-pane fade{% if active_tab == 'experience' %} show active{% endif %}" id="nav-experience"
      role="tabpanel" aria-labelledby="nav-experience-tab">
      <h3>Experience</h3>
      {% if experience %}
      <!-- Display saved experience details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Job Title</th>
            <th>Company Name</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Description</th>
            <th>Certificate</th>
            <th></th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for exp in experience %}
          <tr>
            <td>{{ exp.job_title }}</td>
            <td>{{ exp.company_name }}</td>
            <td>{{ exp.start_date }}</td>
            <td>{{ exp.end_date }}</td>
            <td>{{ exp.description }}</td>
            <td>{{ exp.certificate.name }}</td>
            <td>
              {% if exp.certificate %}
              <a href="{{ exp.certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary"
                onclick="window.location.href='{% url 'form_view' tab='experience' %}?edit_instance_id={{ exp.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=exp.id %}" method="post"
                style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No experience details saved.</p>
      {% endif %}

      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}

        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary"
          onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>

    </div>

    <!--Project tab -->
    <div class="tab-pane fade{% if active_tab == 'project' %} show active{% endif %}" id="nav-project" role="tabpanel"
      aria-labelledby="nav-project-tab">
      <h3>Project</h3>
      {% if project %}
      <!-- Display saved experience details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Project Name</th>
            <th>Description</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Project Links</th>
            <th>Document</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for proj in project %}
          <tr>
            <td>{{ proj.project_name }}</td>
            <td>{{ proj.description }}</td>
            <td>{{ proj.start_date }}</td>
            <td>{{ proj.end_date }}</td>
            <td><a href="{{ proj.project_links.url }}" target="_blank">{{proj.project_links}}</a></td>
            <td>
              {% if proj.project_document %}
              <a href="{{ proj.project_document.url }}" target="_blank">View Document</a>
              {% else %}
              No document uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary"
                onclick="window.location.href='{% url 'form_view' tab='project' %}?edit_instance_id={{ proj.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=proj.id %}" method="post"
                style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No experience details saved.</p>
      {% endif %}
      <form method="post" action="{% url 'form_view' tab='project' %}">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary"
          onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>
    </div>

    <!--Skills tab -->
    <div class="tab-pane fade{% if active_tab == 'skills' %} show active{% endif %}" id="nav-skills" role="tabpanel" aria-labelledby="nav-skills-tab">
      <h3>Skills</h3>
      {% if skills %}
      <!-- Display saved skills details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Skill Name</th>
            <th>Proficiency Level</th>
            <th>Skill Certificate</th>
            <th></th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for skill in skills %}
          <tr>
            <td>{{ skill.skill_name }}</td>
            <td>{{ skill.proficiency_level }}</td>
            <td>{{ skill.skill_certificate.name }}</td>
            <td>
              {% if skill.skill_certificate %}
              <a href="{{ skill.skill_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary" onclick="window.location.href='{% url 'form_view' tab='skills' %}?edit_instance_id={{ skill.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=skill.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No skills details saved.</p>
      {% endif %}

      <form method="post" action="{% url 'form_view' tab='skills' %}" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
          <label for="id_skill_name">Skill Name:</label>
          {{ current_form.skill_name }}
        </div>
        <div class="form-group">
          <label for="id_proficiency_level">Proficiency Level:</label><br>
          <div class="btn-group proficiency-level" data-toggle="buttons">
              {% for level in proficiency_levels %}
              <label class="btn btn-secondary {% if level == current_form.proficiency_level.value %} active {% endif %}">
                  <input type="radio" name="proficiency_level" autocomplete="off" value="{{ level }}">
                  {{ level }}
              </label>
              {% endfor %}
          </div>
        </div>      
        <div class="form-group">
          <label for="id_skill_certificate">Skill Certificate:</label>
          {{ current_form.skill_certificate }}
        </div>
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>
            
    </div>

    <!--Achievements tab -->
    <div class="tab-pane fade{% if active_tab == 'achievements' %} show active{% endif %}" id="nav-achievements" role="tabpanel" aria-labelledby="nav-achievements-tab">
      <h3>Achievements</h3>
      {% if achievements %}
      <!-- Display saved achievements details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Achievement Title</th>
            <th>Description</th>
            <th>Achievement Date</th>
            <th>Achievement Certificate</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for achievement in achievements %}
          <tr>
            <td>{{ achievement.achievement_title }}</td>
            <td>{{ achievement.description }}</td>
            <td>{{ achievement.achievement_date }}</td>
            <td>{{ achievement.achievement_certificate.name }}</td>
            <td>
              {% if achievement.achievement_certificate %}
              <a href="{{ achievement.achievement_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary" onclick="window.location.href='{% url 'form_view' tab='achievements' %}?edit_instance_id={{ achievement.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=achievement.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No achievements details saved.</p>
      {% endif %}
      <form method="post" action="{% url 'form_view' tab='achievements' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>
    </div>

    <!--Interests tab -->
    <div class="tab-pane fade{% if active_tab == 'interests' %} show active{% endif %}" id="nav-interests" role="tabpanel" aria-labelledby="nav-interests-tab">
      <h3>Interests</h3>
      {% if interests %}
      <!-- Display saved interests details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Interest</th>
            <th>Interest Certificate</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for interest in interests %}
          <tr>
            <td>{{ interest.interest }}</td>
            <td>{{ interest.interest_certificate.name }}</td>
            <td>
              {% if interest.interest_certificate %}
              <a href="{{ interest.interest_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary" onclick="window.location.href='{% url 'form_view' tab='interests' %}?edit_instance_id={{ interest.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=interest.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No interests details saved.</p>
      {% endif %}
      <form method="post" action="{% url 'form_view' tab='interests' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>
    </div>

    <!--Languages tab -->
    <div class="tab-pane fade{% if active_tab == 'languages' %} show active{% endif %}" id="nav-languages" role="tabpanel" aria-labelledby="nav-languages-tab">
      <h3>Languages</h3>
      {% if languages %}
      <!-- Display saved languages details in a table -->
      <table class="table">
        <thead>
          <tr>
            <th>Language</th>
            <th>Proficiency</th>
            <th>Language Certificate</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for language in languages %}
          <tr>
            <td>{{ language.language }}</td>
            <td>{{ language.proficiency }}</td>
            <td>{{ language.language_certificate.name }}</td>
            <td>
              {% if language.language_certificate %}
              <a href="{{ language.language_certificate.url }}" target="_blank">View Certificate</a>
              {% else %}
              No certificate uploaded
              {% endif %}
            </td>
            <td>
              <button type="button" class="btn btn-primary" onclick="window.location.href='{% url 'form_view' tab='languages' %}?edit_instance_id={{ language.id }}'">Edit</button>
              <form action="{% url 'delete_instance' active_tab=active_tab instance_id=language.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No languages details saved.</p>
      {% endif %}
      <form method="post" action="{% url 'form_view' tab='languages' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ current_form.as_p }}
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'form_view' tab=next_tab %}'">Next</button>
      </form>
    </div>
    
  </div>
</div>
{% endblock maincontent %}

{% block js %}

{% comment %} <script type="text/javascript">
  $(document).ready(function() {
      $("#id_course").change(function() {
          var url = "{% url 'ajax_load_specializations' %}";
          var courseId = $(this).val();

          $.ajax({
              url: url,
              data: {
                  'course_id': courseId
              },
              success: function(data) {
                  $("#id_specialization").html(data);
              }
          });
      });
  });
</script> {% endcomment %}

{% endblock js %}